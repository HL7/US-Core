resourceType: StructureDefinition
id: us-core-pmo-servicerequest
url: http://hl7.org/fhir/us/core/StructureDefinition/us-core-pmo-servicerequest
name: USCorePMOServiceRequestProfile
title: US Core PMO ServiceRequest Profile
status: active
date: 2025-08-26
description: |
  The US Core PMO ServiceRequest Profile inherits from the [FHIR ServiceRequest](https://hl7.org/fhir/R4/servicerequest.html) resource; refer to it for scope and usage definitions. This profile represents an order based on a PMO document and references the [US Core ADI DocumentReference Profile](StructureDefinition-us-core-adi-documentreference.html) to communicate the contents of the PMO document, such as POLST, MOLST, or other state-specific forms. PMO documents follow the patient across care settings and are typically stored as scanned images in EMRs/EHRs. Together, these two profiles satisfy the USCDI's PMO Order Data Element's intent to represent orders based on an individual's PMO. The US Core PMO ServiceRequest Profile establishes minimum expectations for recording, searching, and fetching PMO-related ServiceRequest information, specifying core elements, extensions, vocabularies, and value sets that SHALL be present to promote interoperability.
kind: resource
abstract: false
type: ServiceRequest
baseDefinition: http://hl7.org/fhir/StructureDefinition/ServiceRequest
derivation: constraint
differential:
  element:
    - id: ServiceRequest
      path: ServiceRequest
      mustSupport: false

    - id: ServiceRequest.status
      path: ServiceRequest.status
      mustSupport: true

    - id: ServiceRequest.intent
      path: ServiceRequest.intent
      comment: To allow for the resource life cycle, no constraint on intent for use when documenting derived medical orders. Use "directive" when part of a FHIR-based PMO document.
      mustSupport: true
    # fixedCode: directive

    - id: ServiceRequest.category
      path: ServiceRequest.category
      min: 1
      slicing:
        discriminator:
          - type: value
            path: $this
        rules: open
      mustSupport: true

#  currently a 2-level category heirarchy
# 'A single  mandatory "PMO" category?'
    - id: ServiceRequest.category:us-core-pmo
      path: ServiceRequest.category
      sliceName: us-core-pmo
      short: A ServiceRequest category representing an order derived from a PMO document
      min: 1
      max: '1'
      patternCodeableConcept:
        coding:
          - system: http://hl7.org/fhir/us/core/CodeSystem/us-core-category
            code: PMO # This code represents a medical order derived from a PMO document
      mustSupport: true


#  OPtional 'Multiple portable medical order categories'
    - id: ServiceRequest.category:us-core-pmo-category
      path: ServiceRequest.category
      sliceName: us-core-pmo-category
      short: PMO order categories
      binding:
        strength: required
        description: The Portable Medical Order Categories Value Set is a "starter set" of categories supported for PMO ServiceRequests. Note that other codes are permitted, see [Required Bindings When Slicing by Value Sets](general-requirements.html#required-bindings-when-slicing-by-valuesets)
        valueSet: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1267.34
      mustSupport: false

# Grouped Valueset - Answers to panels codes in category codes
    - id: ServiceRequest.code
      path: ServiceRequest.code
      comment: |-
        The `ServiceRequest.code` is bound to [Portable Medical Orders - Detailed Categories and Interventions](https://vsac.nlm.nih.gov/valueset/2.16.840.1.113762.1.4.1267.35/expansion), which is comprised of code sets for each [Portable Medical Order Categories](https://vsac.nlm.nih.gov/valueset/2.16.840.1.113762.1.4.1267.34/Expansion) found in `ServiceRequest.category:us-core-pmo-category`.  For proper context, these codes **SHOULD** be aligned with the appropriate Category as follows.   - When there is no appropriate code to capture the order, plain text can be used here and in the optional `ServiceRequest.orderDetail` element.
      min: 1
      mustSupport: true
      binding:

    # # === Using Additional bindings for various PMO categories instead of single valuset - see Pacios valuesets ===
    #   extension:
    #     - url: 'http://hl7.org/fhir/tools/StructureDefinition/additional-binding'
    #       extension:
    #         - url: key
    #           valueId: us-core-cardiopulmonary-resuscitation-orders # based on the loinc panel code
    #         - url: purpose
    #           valueCode: extensible
    #         - url: valueSet
    #           valueCanonical: >-   # based on the Pacio VS
    #             http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1115.31
    #         - url: documentation
    #           valueMarkdown: >-  # based on the value VS description
    #             Cardiopulmonary resuscitation procedures grouping
    #         - url: shortDoco
    #           valueString: SeviceRequest.category = Cardiopulmonary resuscitation orders # based on the loinc panel code


    #     - url: 'http://hl7.org/fhir/tools/StructureDefinition/additional-binding'
    #       extension:
    #         - url: key
    #           valueId: us-core-initial-portable-medical-treatment-orders # based on the loinc panel code
    #         - url: purpose
    #           valueCode: extensible
    #         - url: valueSet
    #           valueCanonical: >-   # based on the Pacio VS
    #             http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1115.33
    #         - url: documentation
    #           valueMarkdown: >-  # based on the value VS description
    #             Initial Treatment Portable Medical Order Procedures Grouping
    #         - url: shortDoco
    #           valueString: SeviceRequest.category = Initial portable medical treatment orders # (https://vsac.nlm.nih.gov/valueset/2.16.840.1.113762.1.4.1115.33/expansion/Latest) # based on the loinc panel code

    #     - url: 'http://hl7.org/fhir/tools/StructureDefinition/additional-binding'
    #       extension:
    #         - url: key
    #           valueId: additional-portable-medical-orders-or-instructions# based on the loinc panel code
    #         - url: purpose
    #           valueCode: extensible
    #         - url: valueSet
    #           valueCanonical: >-   # based on the Pacio VS
    #             http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1115.32
    #         - url: documentation
    #           valueMarkdown: >-  # based on the value VS description
    #             Additional Portable Medical Order Procedures
    #         - url: shortDoco
    #           valueString: SeviceRequest.category = Additional portable medical orders or instructions # based on the loinc panel code
    # # ========================================================================== ===

        strength: extensible
        valueSet: http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1267.35

#   # require text since mostly text today
#   - id: ServiceRequest.code.text
#     path: ServiceRequest.code.text
#     mustSupport: true
#     short: "Plain text representation of the PMO procedure or service."

# # require text since mostly text today
#   - id: ServiceRequest.orderDetail
#     path: ServiceRequest.orderDetail
#     mustSupport: true

#   - id: ServiceRequest.orderDetail.text
#     path: ServiceRequest.orderDetail.text
#     mustSupport: true
#     short: "Plain text representation to capture additional PMO order details."

# limit to Patient
    - id: ServiceRequest.subject
      path: ServiceRequest.subject
    # short: limited to Patient
      type:
        - code: Reference
          targetProfile:
            - http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient
      mustSupport: true

# not used in context of a PMO Document. (Invariant or narrative)
    - id: ServiceRequest.encounter
      path: ServiceRequest.encounter
      comment: This element is not present when part of a PMO Document.
      type:
        - code: Reference
          targetProfile:
            - http://hl7.org/fhir/us/core/StructureDefinition/us-core-encounter
      mustSupport: true


    - id: ServiceRequest.occurrence[x]
      path: ServiceRequest.occurrence[x]
    # short: Often just a start date
      type:
        - extension:
            - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
              valueBoolean: true
          code: Period
        - code: dateTime
        - code: Timing
      mustSupport: true

    - id: ServiceRequest.authoredOn
      path: ServiceRequest.authoredOn
      comment: Date instantiated (executable) order signed vs date of PMO document. These dates are the same if part of PMO document
      mustSupport: true

# Authored only by Practitioner What if AI gets into the act ...Device?
    - id: ServiceRequest.requester
      path: ServiceRequest.requester
    # short: Authored only by Practitioner
      type:
        - code: Reference
          targetProfile:
            - http://hl7.org/fhir/us/core/StructureDefinition/us-core-practitioner
            - http://hl7.org/fhir/us/core/StructureDefinition/us-core-organization
      # - http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient
            - http://hl7.org/fhir/StructureDefinition/PractitionerRole
      # - http://hl7.org/fhir/us/core/StructureDefinition/us-core-relatedperson
      # - http://hl7.org/fhir/StructureDefinition/Device
          _targetProfile:
            - extension:
                - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
                  valueBoolean: true
            - extension:
                - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
                  valueBoolean: false
            - extension:
                - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
                  valueBoolean: false
      # - extension:
      #   - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
      #     valueBoolean: false
      # - extension:
      #   - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
      #     valueBoolean: false
      # - extension:
      #   - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
      #     valueBoolean: false
      mustSupport: true
  # - id: ServiceRequest.reasonCode
  #   path: ServiceRequest.reasonCode
  #   binding:
  #     strength: extensible
  #     valueSet: http://hl7.org/fhir/us/core/ValueSet/us-core-condition-code
  #   mustSupport: true

# link to the scanned PMO document - using reasonReference based US Core
# Other option is supportingInfo
# Best option would be basedOn but not supported in FHIR R4
# What about supporting QuestionnnaireResponse Directly - Base FHIR question
    - id: ServiceRequest.reasonReference
      path: ServiceRequest.reasonReference
      type:
        - code: Reference
          targetProfile:
            - http://hl7.org/fhir/us/core/StructureDefinition/us-core-adi-documentreference
            - http://hl7.org/fhir/us/core/StructureDefinition/us-core-documentreference
            - http://hl7.org/fhir/us/core/StructureDefinition/us-core-condition-problems-health-concerns
            - http://hl7.org/fhir/StructureDefinition/Observation
            - http://hl7.org/fhir/StructureDefinition/DiagnosticReport
          _targetProfile:
            - extension:
                - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
                  valueBoolean: true
            - extension:
                - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
                  valueBoolean: false
            - extension:
                - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
                  valueBoolean: false
            - extension:
                - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
                  valueBoolean: false
            - extension:
                - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
                  valueBoolean: false
      mustSupport: true
      short: Reference to the PMO document
extension:
  - url: http://hl7.org/fhir/StructureDefinition/structuredefinition-fmm
    valueInteger: 2
