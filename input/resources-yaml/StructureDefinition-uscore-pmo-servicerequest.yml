resourceType: StructureDefinition
id: us-core-pmo-servicerequest
url: http://hl7.org/fhir/us/core/StructureDefinition/us-core-pmo-servicerequest
name: USCorePMOServiceRequestProfile
title: US Core PMO ServiceRequest Profile
status: draft
date: 2025-08-26
description: |
  The US Core PMO ServiceRequest Profile inherits from the [FHIR ServiceRequest](https://hl7.org/fhir/R4/servicerequest.html) resource; refer to it for scope and usage definitions. This profile represents an order based on a PMO document and references the [US Core ADI DocumentReference Profile](StructureDefinition-us-core-adi-documentreference.html) to communicate the contents of the PMO document, such as POLST, MOLST, or other state-specific forms. PMO documents follow the patient across care settings and are typically stored as scanned images in EMRs/EHRs. Together, these two profiles satisfy the USCDI's PMO Order Data Element's intent to represent orders based on an individual's PMO. The US Core PMO ServiceRequest Profile establishes minimum expectations for recording, searching, and fetching PMO-related ServiceRequest information, specifying core elements, extensions, vocabularies, and value sets that SHALL be present to promote interoperability.
kind: resource
abstract: false
type: ServiceRequest
baseDefinition: http://hl7.org/fhir/StructureDefinition/ServiceRequest
derivation: constraint
differential:
  element:
  - id: ServiceRequest
    path: ServiceRequest
    mustSupport: false

  - id: ServiceRequest.status
    path: ServiceRequest.status
    mustSupport: true

  - id: ServiceRequest.intent
    path: ServiceRequest.intent
    short: 'Note: To allow for the resource life cycle, no constraint on intent, use "directive" in PMO document'
    mustSupport: true
    # fixedCode: directive

  - id: ServiceRequest.category
    path: ServiceRequest.category
    slicing:
      discriminator:
      - type: value
        path: $this
      rules: open
    mustSupport: true

# 'Multiple portable medical order categories vs a single "PMO" category?'
#  currently a 2-level heirarchy
#  Option to move the panel codes to code and answers to orderDetails? for 3 level heirarchy
  - id: ServiceRequest.category:us-core-pmo
    path: ServiceRequest.category
    sliceName: us-core-pmo
    short: 'Multiple portable medical order categories vs a single "PMO" category (2 vs 3 level code heirarchy)?'
    mustSupport: true
    binding:
      strength: extensible
      description: |
       [Portable Medical Order panel codes](https://loinc.org/100821-8)
      valueSet: http://hl7.org/fhir/us/core/ValueSet/us-core-portable-medical-orders

# Answers to panels code in category codes
  - id: ServiceRequest.code
    path: ServiceRequest.code
    min: 1
    mustSupport: true
    binding:

    # === Additional bindings for various PMO categories - see Pacios valueset ===
      extension:
        - url: 'http://hl7.org/fhir/tools/StructureDefinition/additional-binding'
          extension:
            - url: key
              valueId: us-core-cardiopulmonary-resuscitation-orders # based on the loinc panel code
            - url: purpose
              valueCode: extensible
            - url: valueSet
              valueCanonical: >-   # based on the Pacio VS
                http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1115.31
            - url: documentation
              valueMarkdown: >-  # based on the value VS description
                Cardiopulmonary resuscitation procedures grouping
            - url: shortDoco
              valueString: SeviceRequest.category = Cardiopulmonary resuscitation orders # based on the loinc panel code


        - url: 'http://hl7.org/fhir/tools/StructureDefinition/additional-binding'
          extension:
            - url: key
              valueId: us-core-initial-portable-medical-treatment-orders # based on the loinc panel code
            - url: purpose
              valueCode: extensible
            - url: valueSet
              valueCanonical: >-   # based on the Pacio VS
                http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1115.33
            - url: documentation
              valueMarkdown: >-  # based on the value VS description
                Initial Treatment Portable Medical Order Procedures Grouping
            - url: shortDoco
              valueString: SeviceRequest.category = Initial portable medical treatment orders # (https://vsac.nlm.nih.gov/valueset/2.16.840.1.113762.1.4.1115.33/expansion/Latest) # based on the loinc panel code

        - url: 'http://hl7.org/fhir/tools/StructureDefinition/additional-binding'
          extension:
            - url: key
              valueId: additional-portable-medical-orders-or-instructions# based on the loinc panel code
            - url: purpose
              valueCode: extensible
            - url: valueSet
              valueCanonical: >-   # based on the Pacio VS
                http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1115.32
            - url: documentation
              valueMarkdown: >-  # based on the value VS description
                Additional Portable Medical Order Procedures
            - url: shortDoco
              valueString: SeviceRequest.category = Additional portable medical orders or instructions # based on the loinc panel code
    # ========================================================================== ===

      strength: extensible
      description: Portable Medical Order panel answers - mostly free-text
      valueSet: http://hl7.org/fhir/us/core/ValueSet/us-core-pmo-procedure-code

  # require text since mostly text today
  - id: ServiceRequest.code.text
    path: ServiceRequest.code.text
    mustSupport: true
    short: "Plain text representation of the PMO procedure or service."

# require text since mostly text today
  - id: ServiceRequest.orderDetail
    path: ServiceRequest.orderDetail
    mustSupport: true

  - id: ServiceRequest.orderDetail.text
    path: ServiceRequest.orderDetail.text
    mustSupport: true
    short: "Plain text representation to capture additional PMO order details."

# limit to Patient
  - id: ServiceRequest.subject
    path: ServiceRequest.subject
    short: limited to Patient
    type:
    - code: Reference
      targetProfile:
      - http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient
    mustSupport: true

# not used in context of a PMO Document. (Invariant or narrative)
  - id: ServiceRequest.encounter
    path: ServiceRequest.encounter
    short: '**NOT USED WHEN PART OF A PMO DOCUMENT**'
    type:
    - code: Reference
      targetProfile:
      - http://hl7.org/fhir/us/core/StructureDefinition/us-core-encounter
    mustSupport: true


  - id: ServiceRequest.occurrence[x]
    path: ServiceRequest.occurrence[x]
    short: Often just a start date
    type:
    - extension:
      - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
        valueBoolean: true
      code: Period
    - code: dateTime
    - code: Timing
    mustSupport: true

  - id: ServiceRequest.authoredOn
    path: ServiceRequest.authoredOn
    short: Date Order signed vs date of PMO document - same if part of PMO document
    mustSupport: true

# Authored only by Practitioner What if AI gets into the act ...Device?
  - id: ServiceRequest.requester
    path: ServiceRequest.requester
    short: Authored only by Practitioner
    type:
    - code: Reference
      targetProfile:
      - http://hl7.org/fhir/us/core/StructureDefinition/us-core-practitioner
      - http://hl7.org/fhir/us/core/StructureDefinition/us-core-organization
      # - http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient
      - http://hl7.org/fhir/StructureDefinition/PractitionerRole
      # - http://hl7.org/fhir/us/core/StructureDefinition/us-core-relatedperson
      # - http://hl7.org/fhir/StructureDefinition/Device
      _targetProfile:
      - extension:
        - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
          valueBoolean: true
      - extension:
        - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
          valueBoolean: false
      - extension:
        - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
          valueBoolean: false
      # - extension:
      #   - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
      #     valueBoolean: false
      # - extension:
      #   - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
      #     valueBoolean: false
      # - extension:
      #   - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
      #     valueBoolean: false
    mustSupport: true
  - id: ServiceRequest.reasonCode
    path: ServiceRequest.reasonCode
    binding:
      strength: extensible
      valueSet: http://hl7.org/fhir/us/core/ValueSet/us-core-condition-code
    mustSupport: true

# link to the scanned PMO document - using reasonReference based US Core
# Other option is supportingInfo
# Best option would be basedOn but not supported in FHIR R4
# What about supporting QuestionnnaireResponse Directly - Base FHIR question
  - id: ServiceRequest.reasonReference
    path: ServiceRequest.reasonReference
    type:
    - code: Reference
      targetProfile:
      - http://hl7.org/fhir/us/core/StructureDefinition/us-core-adi-documentreference
      - http://hl7.org/fhir/StructureDefinition/us-core-condition
      - http://hl7.org/fhir/StructureDefinition/us-core-observation
      - http://hl7.org/fhir/StructureDefinition/us-core-diagnosticreport
      _targetProfile:
      - extension:
        - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
          valueBoolean: true
      - extension:
        - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
          valueBoolean: false
      - extension:
        - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
          valueBoolean: false
      - extension:
        - url: http://hl7.org/fhir/StructureDefinition/elementdefinition-type-must-support
          valueBoolean: false
    mustSupport: true
    short: "US Core ADI DocumentReference Profile or other US Core profiles that support the requested PMO service."
